on:
  push:
  schedule:
    - cron: "28 1/1 * * *"

jobs:
  extended-testing:
    runs-on: ubuntu-latest
    name: Extended testing
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Time of last commit
        id: committime
        run: |
          now=`date +%s`
          lct=`git show -s --format=%ct ${GITHUB_SHA}`
          let "since=${now} - ${lct}"
          echo ${since}
          let "hours=4*60*60"
          run_tests=skip
          echo "h1"
          if [ "${since}" -gt "${hours}" ]; then run_tests=run; fi
          echo "h2"
          echo "run_tests=${run_tests}" >> $GITHUB_ENV
      - name: Skip tests
        id: no-recent-commit
        if: ${{ env.run_tests }} == 'skip'
        run: |
          echo "No recent commit"
      - name: Running tests
        id: recent-commit
        if: ${{ env.run_tests }} == 'run'
        run: |
          echo "Recent commit"
